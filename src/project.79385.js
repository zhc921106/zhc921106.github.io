window.__require=function t(o,e,n){function i(s,r){if(!e[s]){if(!o[s]){var h=s.split("/");if(h=h[h.length-1],!o[h]){var a="function"==typeof __require&&__require;if(!r&&a)return a(h,!0);if(c)return c(h,!0);throw new Error("Cannot find module '"+s+"'")}}var u=e[s]={exports:{}};o[s][0].call(u.exports,function(t){return i(o[s][1][t]||t)},u,u.exports,t,o,e,n)}return e[s].exports}for(var c="function"==typeof __require&&__require,s=0;s<n.length;s++)i(n[s]);return i}({Bomb:[function(t,o,e){"use strict";cc._RF.push(o,"5fcfc4Z7clDXoeudR1g8txp","Bomb");var n=function(t,o){return Math.random()*(o-t)+t},i=Math.abs;cc.Class({extends:cc.Component,properties:{},onLoad:function(){this.curArr=[];for(var t=this.node.children[0],o=0;o<100;o++){cc.instantiate(t).parent=this.node}this.node.z=-1e6},reset:function(){for(var t=this.node.children,o=0;o<t.length;o++){t[o].position=cc.v3(0,0,0)}this.curArr.length=0},lanuch:function(t){this.node.position=t,this.curArr.length=0;for(var o=this.node.children,e=0;e<o.length;e++){var n=o[e];n.position=cc.v3(0,0,0),n.setScale(20,20,20),this.curArr.push(n)}},update:function(t){if(!(this.curArr.length<1)){this.curArr.forEach(function(o){0==o.x&&(o.dx=n(-20,20)),o.x+=o.dx,0==o.y&&(o.dy=n(-20,20)),o.y+=o.dy,0==o.z&&(o.dz=n(-20,20)),o.z+=o.dz,o.dx>0?o.dx+=5*t:o.dx-=5*t,o.dy>0?o.dy+=5*t:o.dy-=5*t,o.dz>0?o.dz+=5*t:o.dz-=5*t,(i(o.x)>600||i(o.y)>600||i(o.z)>600)&&(o.z=-1e6)})}}}),cc._RF.pop()},{}],HelloWorld:[function(t,o,e){"use strict";cc._RF.push(o,"280c3rsZJJKnZ9RqbALVwtK","HelloWorld"),cc.Class({extends:cc.Component,properties:{touch:cc.Node,cam3D:cc.Node,role:cc.Node,obstacle:cc.Node,bomb:cc.Component,motion:cc.Node,canvas:cc.Node},onLoad:function(){this._initData(),this._initTouch(),this._initKeyBoardTouch(),this._initDraw()},updates:function(t){},_checkRay:function(t){for(var o=this.cam3DCmp.getRay(t),e=cc.geomUtils.intersect.raycast(this.obstacle,o),n=0;n<e.length;n++){var i=e[n].node;this.bomb.lanuch(i.position),i.getComponent("Rotate").reset()}},_initMoveTouch:function(){var t=cc.find("Canvas");t.on(cc.Node.EventType.TOUCH_START,this.onTouchStart,this),t.on(cc.Node.EventType.TOUCH_MOVE,this.onTouchMove,this),t.on(cc.Node.EventType.TOUCH_END,this.onTouchEnd,this),this.touchPos=void 0,this.touchArr=[]},onTouchStart:function(t){this.touchPos=t.touch.getLocation();this._setMotionStreak();this.motionCmp.reset()},onTouchMove:function(t){this.touchPos=t.touch.getLocation();var o=this._setMotionStreak();this.drawg(o,this.touchPos)},onTouchEnd:function(t){this.touchPos=null},_initData:function(){this.ratioSpeed=.5,this.moveSpeed=20,this.motionCmp=this.motion.getComponent(cc.MotionStreak),this.cam3DCmp=this.cam3D.getComponent(cc.Camera)},_initTouch:function(){this._initMoveTouch()},onClickW:function(){this.role.z-=this.moveSpeed},onClickA:function(){console.log("onClickA"),this.role.x-=this.moveSpeed},onClickD:function(){this.role.x+=this.moveSpeed},onClickS:function(){this.role.z+=this.moveSpeed},_setMotionStreak:function(t){var o=this.canvas.convertToNodeSpaceAR(this.touchPos);return this.motion.position=o,o},_initKeyBoardTouch:function(){var t=this,o={87:"W",65:"A",83:"S",68:"D"};cc.systemEvent.on(cc.SystemEvent.EventType.KEY_DOWN,function(e){var n="onClick"+o[e.keyCode];t[n]&&t[n]()})},_initDraw:function(){var t=new cc.Node;t.parent=this.canvas,t.group="ui";var o=t.addComponent(cc.Graphics);o.strokeColor=cc.Color.RED,this.g=o,this.garr=[]},drawg:function(t,o){var e=this,n=this.g;n.clear(),this.garr.unshift([t,o,.2]),this.garr.forEach(function(t){var o=t[0];n.circle(o.x,o.y,4);var i=t[1];e._checkRay(i)}),n.stroke()},update:function(t){if(this.garr.length>0){for(var o=0;o<this.garr.length;o++){var e=this.garr[o][2];e-=t,this.garr[o][2]=e,e<0&&(this.garr.splice(o,1),o--)}0==this.garr.length&&this.g.clear()}}}),cc._RF.pop()},{}],MotionStreak:[function(t,o,e){"use strict";cc._RF.push(o,"1d503qnhcRAH7Z8U26h3bht","MotionStreak"),cc.Class({extends:cc.Component,properties:{},onLoad:function(){this.node.getComponent(cc.MotionStreak)},update:function(t){}}),cc._RF.pop()},{}],Obstacle:[function(t,o,e){"use strict";cc._RF.push(o,"8c44cE8jYVBYoWtms6HZYrx","Obstacle"),cc.Class({extends:cc.Component,properties:{},onLoad:function(){this._init(),this._loop()},_init:function(){this.curMap={};for(var t=this.node.children,o=0;o<t.length;o++){var e=t[o];this.curMap[e.name]=e}t=this.node.children},_loop:function(){for(var t in this.curMap){this.curMap[t].active=!0}},update:function(t){}}),cc._RF.pop()},{}],Rotate:[function(t,o,e){"use strict";cc._RF.push(o,"0ad2bEYaRZOQ6xmgHRZucbT","Rotate");var n=function(t,o){return Math.floor(Math.random()*(o-t))+t};cc.Class({extends:cc.Component,properties:{rotate:{type:cc.Integer,default:4},speed:{type:cc.Integer,default:30},delay:{type:cc.Integer,default:0}},_reset:function(){this.dt=0,this.node.x=n(-400,400),this.node.y=n(200,400),this.node.z=-3450},reset:function(t){this._reset(),this.delay=n(0,4)},onLoad:function(){this.scale=this.node.scale,this._reset()},update:function(t){if(this.node.eulerAngles=cc.v3(Date.now()/this.rotate,Date.now()/this.rotate,0),!(this.delay<0||(this.dt+=t,this.dt<this.delay)))if(this.node.z>1e3)this.reset();else{this.node.z+=10*this.dt+this.speed;var o=this.scale+n(-4,4);this.node.setScale(o,o,o)}}}),cc._RF.pop()},{}]},{},["Bomb","HelloWorld","MotionStreak","Obstacle","Rotate"]);